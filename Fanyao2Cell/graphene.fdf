
# ========================================================== #
# Basic input file for Siesta code: Pariodic Calculation     #
# System: Graphene (2D)                                      #
# ---------------------------------------------------------- #
# SystemName: name of the system                             #
# SystemName graphene (in this case)                         #
# SystemLabel: name used in output files (nickname)          #
# SystemLabel graphene                                       #
# (After a successful run, you should have files like this:  #
# benzene.DM : Density matrix                                #
# benzene.XV: Final positions and velocities                 #
# ...)                                                       #
# ========================================================== #

SystemName    graphene
SystemLabel   graphene

# ============= Atomic informations ===============

NumberOfAtoms       41 
NumberOfSpecies      2

%block ChemicalSpeciesLabel
 1    6		C
 2	 27		Co
%endblock ChemicalSpeciesLabel

# ======== lattice, cell and coordinates ==========

# === lattice constant ===

LatticeConstant   2.460 Ang

#====== Lattice Vectors - Simulation box ======

%block LatticeVectors
  2.130    1.230000    0.000000
  2.130   -1.230000    0.000000
  0.000    0.000000   15.000000
%endblock LatticeVectors

# === Coordinates and formats (input and output) ===

AtomicCoordinatesFormat Ang
AtomCoorFormatOut  Ang

%block AtomicCoordinatesAndAtomicSpecies
	-0.710000    1.229000    6.000000	1
	0.000000    0.000000    6.000000	1
	1.420000    0.000000    6.000000	1
	2.130000    1.229000    6.000000	1
	1.420000    2.459000    6.000000	1
	0.000000    2.459000    6.000000	1
	3.550000    1.229000    6.000000	1
	4.260000    0.000000    6.000000	1
	5.680000    0.000000    6.000000	1
	6.390000    1.229000    6.000000	1
	5.680000    2.459000    6.000000	1
	4.260000    2.459000    6.000000	1
	2.130000    3.688000    6.000000	1
	3.550000    3.688000    6.000000	1
	1.420000    4.919000    6.000000	1
	4.260000    4.919000    6.000000	1
	7.810000    1.229000    6.000000	1
	8.520000    0.000000    6.000000	1
	9.940000    0.000000    6.000000	1
	10.650000    1.229000    6.000000	1
	12.070000    1.229000    6.000000	1
	12.780000    0.000000    6.000000	1
	14.200000    0.000000    6.000000	1
	14.910000    1.229000    6.000000	1
	8.520000    2.459000    6.000000	1
	9.940000    2.459000    6.000000	1
	14.200000    2.459000    6.000000	1
	12.780000    2.459000    6.000000	1
	6.390000	3.688000	6.000000	1
	7.810000	3.688000	6.000000	1
	10.650000	3.688000	6.000000	1
	12.070000	3.688000	6.000000	1
   -0.710000	3.688000	6.000000	1
	0.000000	4.919000	6.000000	1
	5.680000	4.919000	6.000000	1
	8.520000	4.919000	6.000000	1
	9.940000	4.919000	6.000000	1
	12.780000	4.919000	6.000000	1
	14.200000	4.919000	6.000000	1
	14.910000	3.688000	6.000000	1
	2.130000	6.148000	6.000000	2
%endblock AtomicCoordinatesAndAtomicSpecies

# ============== kspace Grid and cutoff =============

%block kgrid_Monkhorst_Pack
 9   0   0     0.0
 0   9   0     0.0
 0   0   1     0.0
%endblock kgrid_Monkhorst_Pack

MeshCutoff        50 Ry

# ============== Block to create supercells  =============

#%blockSuperCell
# 1   0   0
# 1   1   0
# 0   0   9
#%endblockSuperCell

#==== hold some atoms in the CG relaxation ====

#%block GeometryConstraints
#position from  1 to  180
#%endblock GeometryConstraints


#============== General variables ===================

#= Basis =

PAO.BasisSize     DZP
PAO.EnergyShift   0.03 eV

#============== MD variables =====================
# Type of Run              MD, FC, CG
# SCF  calculation         MD.NumCGsteps     0
# Structure relaxation     MD.NumCGsteps     600
#=================================================

MD.TypeOfRun      CG
MD.NumCGsteps     0
MD.MaxForceTol    0.01  eV/Ang

#=================== SCF variables ========================
# SCF max number of iterations - single point calculation.
# Mixing - 0.1 means 10 percent of the previous density. 
# Pulay - how many densities will be considered.
# Tolerance - criteria to stop
# =========================================================

MaxSCFIterations      300
DM.MixingWeight       0.04
DM.NumberPulay        3
DM.Tolerance           1.d-4

#== Functional ==

XC.functional       LDA
XC.authors          CA


#======== Solution method =====================
# diagon, order-N or transiesta (transiesta)
#----------------------------------------------
# If the system is periodic and has many kpt 
# ParallelOverK    .true.
#==============================================

SolutionMethod  diagon

#====================== Electronic temperature (FD or MP) ====================
#=============== determines the occupation of the electronic states ==========
#=============================================================================

OccupationFunction     FD

ElectronicTemperature  50 meV


#=============== Write ================

WriteMullikenPop                1
WriteBands                      .false.
SaveRho                         T
SaveDeltaRho                    T
SaveHS                          .false.
SaveElectrostaticPotential      .false.
SaveTotalPotential              no
WriteCoorXmol                   .true.
WriteMDXmol                     .true.
#WriteMDhistory                  .false.
WriteEigenvalues                yes

#=============== Calculation Reestart ================

#UseSaveData     true
#DM.UseSaveDM    true
#MD.UseSaveXV    true
#MD.UseSaveCG    true
