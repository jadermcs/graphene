
# ========================================================== #
# Basic input file for Siesta code: Pariodic Calculation     #
# System: Graphene (2D)                                      #
# ---------------------------------------------------------- #
# SystemName: name of the system                             #
# SystemName graphene (in this case)                         #
# SystemLabel: name used in output files (nickname)          #
# SystemLabel graphene                                       #
# (After a successful run, you should have files like this:  #
# benzene.DM : Density matrix                                #
# benzene.XV: Final positions and velocities                 #
# ...)                                                       #
# ========================================================== #

SystemName    graphene
SystemLabel   graphene

# ============= Atomic informations ===============

NumberOfAtoms       18 
NumberOfSpecies      1

%block ChemicalSpeciesLabel
 1    6  C
%endblock ChemicalSpeciesLabel

# ======== lattice, cell and coordinates ==========

# === lattice constant ===

LatticeConstant   2.460 Ang

#====== Lattice Vectors - Simulation box ======

%block LatticeVectors
  2.130    1.230000    0.000000
  2.130   -1.230000    0.000000
  0.000    0.000000   15.000000
%endblock LatticeVectors

# === Coordinates and formats (input and output) ===

AtomicCoordinatesFormat Ang
AtomCoorFormatOut  Ang

%block AtomicCoordinatesAndAtomicSpecies
 -0.710   1.229   6.000    1    #1
  0.000   0.000   6.000    1	#2
  1.420   0.000   6.000    1	#3
  2.130   1.229   6.000    1	#4
  1.420   2.459   6.000    1	#5
  0.000   2.459   6.000    1	#6
  3.550   1.229   6.000    1	#7
  4.260   0.000   6.000    1	#8
  5.680   0.000   6.000    1	#9
  6.390   1.229   6.000    1	#10
  5.680   2.459   6.000    1    #11
  4.260   2.459   6.000    1    #12
  2.130   3.688   6.000    1	#13
  3.550   3.688   6.000    1    #14
  1.420   4.919   6.000    1    #15
  4.260   4.919   6.000    1    #16
  7.810   1.229   6.000    1    #17
  8.520   0.000   6.000    1    #18
  9.940   0.000   6.000    1    #19
 10.650   1.229   6.000    1    #20
 12.070   1.229   6.000    1    #21
 12.780   0.000   6.000    1    #22
 13.490   0.000   6.000    1    #23
 14.200   1.299   6.000    1    #24
 15.620   1.229   6.000    1    #25
#  9.230   2.459   6.000    1    #26
%endblock AtomicCoordinatesAndAtomicSpecies

# ============== kspace Grid and cutoff =============

%block kgrid_Monkhorst_Pack
 9   0   0     0.0
 0   9   0     0.0
 0   0   1     0.0
%endblock kgrid_Monkhorst_Pack

MeshCutoff        50 Ry

# ============== Block to create supercells  =============

#%blockSuperCell
# 1   0   0
# 1   1   0
# 0   0   9
#%endblockSuperCell

#==== hold some atoms in the CG relaxation ====

#%block GeometryConstraints
#position from  1 to  180
#%endblock GeometryConstraints


#============== General variables ===================

#= Basis =

PAO.BasisSize     DZP
PAO.EnergyShift   0.03 eV

#============== MD variables =====================
# Type of Run              MD, FC, CG
# SCF  calculation         MD.NumCGsteps     0
# Structure relaxation     MD.NumCGsteps     600
#=================================================

MD.TypeOfRun      CG
MD.NumCGsteps     0
MD.MaxForceTol    0.01  eV/Ang

#=================== SCF variables ========================
# SCF max number of iterations - single point calculation.
# Mixing - 0.1 means 10 percent of the previous density. 
# Pulay - how many densities will be considered.
# Tolerance - criteria to stop
# =========================================================

MaxSCFIterations      300
DM.MixingWeight       0.04
DM.NumberPulay        3
DM.Tolerance           1.d-4

#== Functional ==

XC.functional       LDA
XC.authors          CA


#======== Solution method =====================
# diagon, order-N or transiesta (transiesta)
#----------------------------------------------
# If the system is periodic and has many kpt 
# ParallelOverK    .true.
#==============================================

SolutionMethod  diagon

#====================== Electronic temperature (FD or MP) ====================
#=============== determines the occupation of the electronic states ==========
#=============================================================================

OccupationFunction     FD

ElectronicTemperature  50 meV


#=============== Write ================

WriteMullikenPop                1
WriteBands                      .false.
SaveRho                         T
SaveDeltaRho                    T
SaveHS                          .false.
SaveElectrostaticPotential      .false.
SaveTotalPotential              no
WriteCoorXmol                   .true.
WriteMDXmol                     .true.
#WriteMDhistory                  .false.
WriteEigenvalues                yes

#=============== Calculation Reestart ================

#UseSaveData     true
#DM.UseSaveDM    true
#MD.UseSaveXV    true
#MD.UseSaveCG    true
